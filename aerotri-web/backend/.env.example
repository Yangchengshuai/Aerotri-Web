# AeroTri Web 环境变量配置示例
#
# 使用方法：
# 1. 复制此文件为 .env: cp .env.example .env
# 2. 编辑 .env 文件，设置您的配置
# 3. 加载环境变量: source .env (Linux/Mac) 或在 IDE 中配置
# 4. 启动服务: uvicorn app.main:app --reload
#
# 注意：也可以直接设置环境变量而不使用 .env 文件
# 优先级：环境变量 > .env 文件 > YAML 配置文件 > 默认值

# ============================================================================
# 应用配置
# ============================================================================

# 运行环境：development（开发）或 production（生产）
# 默认值：production
AEROTRI_ENV=production

# 调试模式：启用后输出详细日志
# 默认值：false
AEROTRI_DEBUG=false

# 日志级别：DEBUG, INFO, WARNING, ERROR
# 默认值：INFO
AEROTRI_LOG_LEVEL=INFO

# 前端源地址（CORS 配置）
# 如果前后端分离部署，设置前端地址
# 示例：http://localhost:3000
# AEROTRI_FRONTEND_ORIGIN=http://localhost:3000

# ============================================================================
# 路径配置
# ============================================================================

# 数据目录：所有数据的根目录
# 相对路径相对于项目根目录，绝对路径也可以
# 默认值：./data
AEROTRI_PATH_DATA_DIR=./data

# 输出目录：任务输出文件存储位置
# 默认值：./data/outputs
# AEROTRI_PATH_OUTPUTS_DIR=./data/outputs

# Block 工作目录
# 默认值：./data/blocks
# AEROTRI_PATH_BLOCKS_DIR=./data/blocks

# 缩略图缓存目录
# 默认值：./data/thumbnails
# AEROTRI_PATH_THUMBNAILS_DIR=./data/thumbnails

# ============================================================================
# 数据库配置
# ============================================================================

# SQLite 数据库文件路径
# 默认值：./data/aerotri.db
AEROTRI_DB_PATH=./data/aerotri.db

# 数据库连接池大小
# 默认值：5
# AEROTRI_DB_POOL_SIZE=5

# ============================================================================
# 算法可执行文件路径
# ============================================================================

# COLMAP 可执行文件路径
# 可以是绝对路径或在 PATH 中的命令名
# 默认值：colmap（从 PATH 查找）
# 示例：/usr/local/bin/colmap 或 /root/work/colmap3.11/colmap/build/src/colmap/exe/colmap
# COLMAP_PATH=/usr/local/bin/colmap

# GLOMAP 可执行文件路径
# 默认值：glormap（从 PATH 查找）
# 示例：/usr/local/bin/glomap 或 /root/work/glomap/build/glomap/glomap
# GLOMAP_PATH=/usr/local/bin/glomap

# InstantSfM 可执行文件路径
# 默认值：ins-sfm
# INSTANTSFM_PATH=ins-sfm

# OpenMVG 二进制文件目录
# 默认值：/usr/local/bin
# 示例：/root/work/openMVG/openMVG_Build/Linux-x86_64-Release
# OPENMVG_BIN_DIR=/usr/local/bin

# OpenMVG 相机传感器数据库路径
# 默认值：/usr/local/share/sensor_width_camera_database.txt
# 示例：/root/work/openMVG/src/openMVG/exif/sensor_width_database/sensor_width_camera_database.txt
# OPENMVG_SENSOR_DB=/usr/local/share/sensor_width_camera_database.txt

# OpenMVS 二进制文件目录
# 默认值：/usr/local/lib/openmvs/bin
# 示例：/root/work/Aerotri-Web/openMVS/make/bin
# OPENMVS_BIN_DIR=/usr/local/lib/openmvs/bin

# Ceres Solver 库路径（可选，通常自动检测）
# 默认值：自动检测
# CERES_LIB_PATH=/usr/local/lib

# ============================================================================
# 3D Gaussian Splatting 配置
# ============================================================================

# 3DGS 仓库路径（包含 train.py 的目录）
# 默认值：/opt/gaussian-splatting
# 示例：/root/work/gs_workspace/gaussian-splatting
GS_REPO_PATH=/opt/gaussian-splatting

# 运行 3DGS 的 Python 解释器
# 需要包含 gaussian-splatting 依赖和 CUDA 扩展
# 默认值：python（系统 Python）
# 示例：/root/miniconda3/envs/gs_env_py310/bin/python
GS_PYTHON=python

# TensorBoard 可执行文件路径
# 默认值：tensorboard（从 PATH 查找）
# TENSORBOARD_PATH=tensorboard

# TensorBoard 端口范围（动态分配）
# 默认值：6006-6100
# TENSORBOARD_PORT_START=6006
# TENSORBOARD_PORT_END=6100

# Network GUI 配置（用于 3DGS 训练可视化）
# 默认值：127.0.0.1:6009-6109
# NETWORK_GUI_IP=127.0.0.1
# NETWORK_GUI_PORT_START=6009
# NETWORK_GUI_PORT_END=6109

# ============================================================================
# SPZ 压缩配置（3DGS Tiles 压缩）
# ============================================================================

# SPZ Python 环境（包含 SPZ Python bindings）
# 默认值：python（系统 Python）
# 示例：/root/miniconda3/envs/spz-env/bin/python
# SPZ_PYTHON=/root/miniconda3/envs/spz-env/bin/python

# ============================================================================
# 图像根路径配置
# ============================================================================

# 图像浏览根目录（单个路径，向后兼容）
# 默认值：./data/images
# 示例：/mnt/data/images
# AEROTRI_IMAGE_ROOT=./data/images

# 图像浏览根目录（多个路径，冒号分隔）
# 优先级高于 AEROTRI_IMAGE_ROOT
# 示例：/data/images:/mnt/storage:/home/user/images
# AEROTRI_IMAGE_ROOTS=/data/images:/mnt/storage

# ============================================================================
# 队列配置
# ============================================================================

# 队列最大并发任务数
# 范围：1-10
# 默认值：1
QUEUE_MAX_CONCURRENT=1

# 队列调度器轮询间隔（秒）
# 默认值：5
# QUEUE_SCHEDULER_INTERVAL=5

# ============================================================================
# GPU 配置
# ============================================================================

# GPU 监控间隔（秒）
# 默认值：2
# GPU_MONITOR_INTERVAL=2

# 自动选择 GPU 策略
# 可选值：most_free（最空闲）、least_memory（最少显存占用）
# 默认值：most_free
# GPU_AUTO_SELECTION=most_free

# ============================================================================
# 通知服务配置（可选）
# ============================================================================

# 是否启用通知服务
# 默认值：false
# NOTIFICATION_ENABLED=false

# 通知服务 URL
# 示例：https://notify.example.com/webhook
# NOTIFICATION_URL=

# 通知服务类型
# 可选值：webhook, email, slack
# NOTIFICATION_TYPE=webhook

# ============================================================================
# Docker 部署示例配置
# ============================================================================

# 如果使用 Docker 部署，可以使用以下配置：

# # 应用配置
# AEROTRI_ENV=production
# AEROTRI_DEBUG=false
#
# # 数据持久化
# AEROTRI_DB_PATH=/data/aerotri.db
# AEROTRI_PATH_DATA_DIR=/data
#
# # 算法路径（Docker 容器内路径）
# COLMAP_PATH=/usr/local/bin/colmap
# GLOMAP_PATH=/usr/local/bin/glomap
#
# # 3DGS 配置
# GS_REPO_PATH=/opt/gaussian-splatting
# GS_PYTHON=/opt/gs_env/bin/python
#
# # 图像存储（挂载卷）
# AEROTRI_IMAGE_ROOTS=/data/images:/mnt/storage
#
# # 队列配置
# QUEUE_MAX_CONCURRENT=2

# ============================================================================
# 开发环境示例配置
# ============================================================================

# # 应用配置
# AEROTRI_ENV=development
# AEROTRI_DEBUG=true
# AEROTRI_LOG_LEVEL=DEBUG
#
# # 前端 CORS（如果前端运行在 localhost:3000）
# AEROTRI_FRONTEND_ORIGIN=http://localhost:3000
#
# # 使用本地编译的算法
# COLMAP_PATH=/root/work/colmap3.11/colmap/build/src/colmap/exe/colmap
# GLOMAP_PATH=/root/work/glomap/build/glomap/glomap
#
# # 开发数据目录
# AEROTRI_PATH_DATA_DIR=./dev_data
# AEROTRI_DB_PATH=./dev_data/aerotri.db
#
# # 图像路径
# AEROTRI_IMAGE_ROOT=./test_images

# ============================================================================
# 配置优先级说明
# ============================================================================

# 配置加载优先级（从高到低）：
# 1. 环境变量（包括 .env 文件中设置的）
# 2. backend/config/settings.{environment}.yaml（环境特定配置）
# 3. backend/config/settings.yaml（主配置文件）
# 4. backend/config/defaults.yaml（默认配置）
#
# 示例：
# - 如果设置了环境变量 COLMAP_PATH=/custom/colmap，则使用该值
# - 如果未设置，从 settings.yaml 中读取
# - 如果 settings.yaml 中也没有，使用默认值 "colmap"
